import{EasyField as e}from"react-formutil";export*from"react-formutil";import r from"@babel/runtime/helpers/esm/defineProperty";import t from"@babel/runtime/helpers/esm/toPropertyKey";import a from"@babel/runtime/helpers/esm/objectSpread2";import n from"@babel/runtime/helpers/esm/objectWithoutProperties";import i from"@babel/runtime/helpers/esm/classCallCheck";import o from"@babel/runtime/helpers/esm/createClass";import l from"@babel/runtime/helpers/esm/possibleConstructorReturn";import s from"@babel/runtime/helpers/esm/getPrototypeOf";import c from"@babel/runtime/helpers/esm/inherits";import u,{Children as p,cloneElement as d,Component as m,createContext as f,isValidElement as v,Fragment as h}from"react";import{isValidElementType as b}from"react-is";import{Form as y,FormControl as g,FormLabel as k,InputGroup as E,FormText as P,FormGroup as C,FormCheck as $,ToggleButton as _,ToggleButtonGroup as F,Col as V,Row as x}from"react-bootstrap";import N from"react-fast-compare";var S=function(e){c(r,e);function r(){i(this,r);return l(this,s(r).apply(this,arguments))}o(r,[{key:"render",value:function e(){var r=this.props,t=r.children,a=r.name,n=r.onChange,i=r.value,o=r.onFocus,l=r.onBlur,s=r.isValid,c=r.isInvalid;var u=function e(r){var t=r.target,a=t.checked,o=t.value;var l=i||[];n(a?l.concat(o):l.filter(function(e){return e!==o}))};return p.map(t,function(e){var r=e.props.value;return d(e,{isValid:s,isInvalid:c,checked:!!i&&i.indexOf(r)>-1,onChange:u,onFocus:o,onBlur:l,name:a})})}}]);return r}(m);var T;try{var j=document.createElement("style");j.type="text/css";document.getElementsByTagName("head")[0].appendChild(j);T=document.styleSheets[document.styleSheets.length-1]}catch(e){}function B(e,r){if(T){if(T.insertRule){T.insertRule("".concat(e," { ").concat(r," }"),0)}else if(T.addRule){T.addRule(e,r,0)}}}var w=f({}),A=w.Consumer,O=w.Provider;var I=1;var R=function e(r){I=r};var Y=y.displayName!=="Form";var G=Y?g:"FormControl";var U=Y?$:"FormCheck";var H=Y?S:"CheckboxGroup";var z=Y?_:"ToggleButton";var L=Y?F:"ToggleButtonGroup";var W=g.Feedback;function D(e){if(e){var r;var t=e.type;if(typeof t!=="string"&&b(t)){if(t.formutilType){return t.formutilType}if(Y){return t}return t.displayName||t.name}return((r=e.props)===null||r===void 0?void 0:r.type)||e.type}}var K=function(m){c(f,m);function f(){var e;var r;i(this,f);for(var t=arguments.length,a=new Array(t),n=0;n<t;n++){a[n]=arguments[n]}r=l(this,(e=s(f)).call.apply(e,[this].concat(a)));r.fields={};r.registerField=function(e,t){return t?r.fields[e]=t:delete r.fields[e]};r.latestValidationProps=null;r.checkHasError=function(e,r,t,a,n){switch(e){case 0:return r&&t&&a;case 1:return r&&t;case 2:return r;default:return false}};r.fetchCurrentValidationProps=function(e){var t=Object.keys(r.fields).map(function(e){return r.fields[e].$new()});var a=t.filter(function(e){return e.$invalid});var n=a.length>0;var i=t.some(function(e){return e.$dirty});var o=t.some(function(e){return e.$touched});var l=t.some(function(e){return e.$focused});var s=a.map(function(t){var a=t.$invalid,n=t.$focused,i=t.$touched,o=t.$dirty,l=t.$getFirstError;var s=r.checkHasError(e,a,o,i,n);return s&&l()}).filter(Boolean);return r.getValidationProps(e,n,i,o,l,s)};r.getValidationProps=function(e,t,a,n,i,o){var l=r.checkHasError(e,t,a,n,i);var s={className:[r.props.className,l&&"has-error",t?"is-invalid":"is-valid",a?"is-dirty":"is-pristine",n?"is-touched":"is-untouched",i?"is-focused":"is-unfocused"].filter(Boolean).join(" ")};var c={};if(l){c.isInvalid=true}if(r.props.feedback&&!t){c.isValid=true}return{groupProps:s,validationProps:c,error:l?u.createElement(W,{type:"invalid"},Array.isArray(o)?o.map(function(e,r){return u.createElement("div",{key:r},e)}):o):null}};return r}o(f,[{key:"componentDidMount",value:function e(){var r;(r=this.registerAncestorField)===null||r===void 0?void 0:r.call(this,this.props.name,this.$fieldutil)}},{key:"componentWillUnmount",value:function e(){var r;(r=this.registerAncestorField)===null||r===void 0?void 0:r.call(this,this.props.name,null)}},{key:"render",value:function i(){var o=this;var l=this.props;var s=l.children,c=l.addons,m=l.label,f=l.helper,b=l.labelCol,y=l.wrapperCol,g=l.validationState,$=l.className,_=l.as,F=l.feedback,S=l.extra,T=l.noStyle,j=l.errorLevel,B=j===void 0?I:j,w=n(l,["children","addons","label","helper","labelCol","wrapperCol","validationState","className","as","feedback","extra","noStyle","errorLevel"]);var R=y?V:h;var Y=!_&&(b||y)?x:_;if(m){if(v(m)){if(b){m=d(m,a({column:true},b))}}else{m=u.createElement(k,Object.assign({column:!!b},b),m)}}var W=c?E:h;var K=c?{size:c.size}:undefined;if(c){if(c.pre){c.pre=u.createElement(E.Prepend,null,v(c.pre)?c.pre:u.createElement(E.Text,null,c.pre))}if(c.end){c.end=u.createElement(E.Append,null,v(c.end)?c.end:u.createElement(E.Text,null,c.end))}}else{c={}}if(f&&!v(f)){f=u.createElement(P,{className:"text-muted"},f)}if(!l.name){var M=this.latestValidationProps=this.fetchCurrentValidationProps(B),q=M.groupProps,J=M.error;Promise.resolve().then(function(){if(!N(o.latestValidationProps,o.fetchCurrentValidationProps(B))){o.forceUpdate()}});return u.createElement(O,{value:{registerField:this.registerField}},u.createElement(C,Object.assign({},w,q,{as:Y}),m,u.createElement(R,y,u.createElement(W,K,c.pre,s,c.end),J||f),S))}var Q=typeof s==="function"?s:p.only(s);var X=D(Q);if(X===G){if(Q.props.as==="select"&&Q.props.multiple){X="multipleSelect"}}switch(X){case U:case z:case"checkbox":case"radio":w.__TYPE__="checked";break;case"multipleSelect":w.__TYPE__="array";break;case H:case L:if(Q.props.type!=="radio"){w.__TYPE__="array"}break;case"checked":case"array":case"object":case"number":case"empty":w.__TYPE__=X;break}return u.createElement(e,Object.assign({},w,{passUtil:"$fieldutil",render:function e(a){var i,s;var p=l.valuePropName,v=p===void 0?"value":p,h=l.changePropName,b=h===void 0?"onChange":h,g=l.focusPropName,k=g===void 0?"onFocus":g,E=l.blurPropName,P=E===void 0?"onBlur":E;var $=a.$fieldutil,_=a[b],F=a[k],V=a[P],x=a[v],N=n(a,["$fieldutil",b,k,P,v].map(t));var j=$.$invalid,O=$.$dirty,I=$.$touched,G=$.$focused,U=$.$getFirstError;var H;switch(w.__TYPE__){case"checked":case"checkbox":case"radio":var z=l.checked,L=z===void 0?true:z,D=l.unchecked,M=D===void 0?false:D;H={checked:x===L,onChange:function e(r){var t=r&&r.target?r.target.checked:r;_(t?L:M,r)}};break;default:H=(i={onCompositionEnd:function e(r){o.isComposition=false;delete o.compositionValue;_(r)},onCompositionStart:function e(){return o.isComposition=true}},r(i,b,X==="multipleSelect"?function(e){_([].slice.call(e.target.options).filter(function(e){return e.selected}).map(function(e){return e.value}),e)}:function(e){if(o.isComposition){o.compositionValue=e.target[v];o.forceUpdate()}else{for(var r=arguments.length,t=new Array(r>1?r-1:0),a=1;a<r;a++){t[a-1]=arguments[a]}_.apply(void 0,[e].concat(t))}}),r(i,v,"compositionValue"in o?o.compositionValue:x),r(i,"name",w.name),i);break}var q=o.getValidationProps(B,j,O,I,G,U()),J=q.groupProps,Z=q.validationProps,ee=q.error;Object.assign(H,(s={},r(s,k,F),r(s,P,V),s),Z);var re=typeof Q==="function"?Q(H):d(Q,H);return u.createElement(A,null,function(e){var r=e.registerField;if(T){o.$fieldutil=$;o.registerAncestorField=r;return re}return u.createElement(C,Object.assign({},N,J,{as:Y}),m,u.createElement(R,y,u.createElement(W,K,c.pre,re,c.end),ee||f),S)})}}))}}]);return f}(m);B(".valid-feedback:empty,.invalid-feedback:empty","display: none !important");B(".has-error .invalid-feedback","display: block");var M=function(e){c(r,e);function r(){i(this,r);return l(this,s(r).apply(this,arguments))}o(r,[{key:"render",value:function e(){var r=this.props,t=r.children,a=r.name,n=r.onChange,i=r.value,o=r.onFocus,l=r.onBlur,s=r.isValid,c=r.isInvalid;var u=function e(r){n(r.target.value,r)};return p.map(t,function(e){var r=e.props.value;return d(e,{isValid:s,isInvalid:c,checked:i===r,onChange:u,onFocus:o,onBlur:l,name:a})})}}]);return r}(m);export{S as CheckboxGroup,K as FormGroup,M as RadioGroup,S as SwitchGroup,R as setErrorLevel};
