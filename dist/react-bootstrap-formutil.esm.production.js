import{EasyField as e}from"react-formutil";export*from"react-formutil";import r,{Children as t,cloneElement as n,Component as o,isValidElement as i,createContext as a,Fragment as c}from"react";import{FormControl as l,FormLabel as u,InputGroup as s,FormText as f,FormGroup as p,ToggleButtonGroup as d,ToggleButton as m,FormCheck as v,Col as y,Row as h}from"react-bootstrap";import b from"react-is";import g from"react-fast-compare";function P(e,r,t){if(r in e){Object.defineProperty(e,r,{value:t,enumerable:true,configurable:true,writable:true})}else{e[r]=t}return e}function O(e){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){O=function e(r){return typeof r}}else{O=function e(r){return r&&typeof Symbol==="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r}}return O(e)}function k(e,r){if(O(e)!=="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==undefined){var n=t.call(e,r||"default");if(O(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function E(e){var r=k(e,"string");return O(r)==="symbol"?r:String(r)}function j(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);if(r)n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}));t.push.apply(t,n)}return t}function _(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};if(r%2){j(Object(t),true).forEach((function(r){P(e,r,t[r])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(e,Object.getOwnPropertyDescriptors(t))}else{j(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}}return e}function w(e,r){if(e==null)return{};var t={};var n=Object.keys(e);var o,i;for(i=0;i<n.length;i++){o=n[i];if(r.indexOf(o)>=0)continue;t[o]=e[o]}return t}function S(e,r){if(e==null)return{};var t=w(e,r);var n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++){n=i[o];if(r.indexOf(n)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(e,n))continue;t[n]=e[n]}}return t}function $(e,r){if(!(e instanceof r)){throw new TypeError("Cannot call a class as a function")}}function C(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}function V(e,r,t){if(r)C(e.prototype,r);if(t)C(e,t);return e}function F(e,r){F=Object.setPrototypeOf||function e(r,t){r.__proto__=t;return r};return F(e,r)}function x(e,r){if(typeof r!=="function"&&r!==null){throw new TypeError("Super expression must either be null or a function")}e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:true,configurable:true}});if(r)F(e,r)}function T(e){T=Object.setPrototypeOf?Object.getPrototypeOf:function e(r){return r.__proto__||Object.getPrototypeOf(r)};return T(e)}function N(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function A(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function R(e,r){if(r&&(O(r)==="object"||typeof r==="function")){return r}return A(e)}function B(e){var r=N();return function t(){var n=T(e),o;if(r){var i=T(this).constructor;o=Reflect.construct(n,arguments,i)}else{o=n.apply(this,arguments)}return R(this,o)}}var D=function(e){x(o,e);var r=B(o);function o(){$(this,o);return r.apply(this,arguments)}V(o,[{key:"render",value:function e(){var r=this.props,o=r.children,i=r.name,a=r.onChange,c=r.value,l=r.onFocus,u=r.onBlur,s=r.isValid,f=r.isInvalid;var p=function e(r){var t=r.target,n=t.checked,o=t.value;var i=c||[];a(n?i.concat(o):i.filter((function(e){return e!==o})))};return t.map(o,(function(e){var r=e.props.value;return n(e,{isValid:s,isInvalid:f,checked:!!c&&c.indexOf(r)>-1,onChange:p,onFocus:l,onBlur:u,name:i})}))}}]);return o}(o);D.formutilType="array";var I;try{var Y=document.createElement("style");Y.type="text/css";document.getElementsByTagName("head")[0].appendChild(Y);I=document.styleSheets[document.styleSheets.length-1]}catch(e){}function U(e,r){if(I){if(I.insertRule){I.insertRule("".concat(e," { ").concat(r," }"),0)}else if(I.addRule){I.addRule(e,r,0)}}}var H=b.isValidElementType;var L=a({}),z=L.Consumer,G=L.Provider;var M=1;var W=function e(r){M=r};var q=l.Feedback;function J(e){if(e){var r=e.type;if(H(r)){if(r.formutilType){return r.formutilType}if(typeof r==="string"&&e.props.type){return e.props.type}}return r||e}}var K=function(o){x(b,o);var a=B(b);function b(){var e;$(this,b);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++){n[o]=arguments[o]}e=a.call.apply(a,[this].concat(n));e.fields={};e.registerField=function(r,t){return t?e.fields[r]=t:delete e.fields[r]};e.latestValidationProps=null;e.checkHasError=function(e,r,t,n,o){switch(e){case 0:return r&&t&&n;case 1:return r&&t;case 2:return r;default:return false}};e.fetchCurrentValidationProps=function(r){var t=Object.keys(e.fields).map((function(r){return e.fields[r].$new()}));var n=t.filter((function(e){return e.$invalid}));var o=n.length>0;var i=t.some((function(e){return e.$dirty}));var a=t.some((function(e){return e.$touched}));var c=t.some((function(e){return e.$focused}));var l=n.map((function(t){var n=t.$invalid,o=t.$focused,i=t.$touched,a=t.$dirty,c=t.$getFirstError;var l=e.checkHasError(r,n,a,i,o);return l&&c()})).filter(Boolean);return e.getValidationProps(r,o,i,a,c,l)};e.getValidationProps=function(t,n,o,i,a,c){var l=e.checkHasError(t,n,o,i,a);var u={className:[e.props.className,l&&"has-error",n?"is-invalid":"is-valid",o?"is-dirty":"is-pristine",i?"is-touched":"is-untouched",a?"is-focused":"is-unfocused"].filter(Boolean).join(" ")};var s={};if(l){s.isInvalid=true}if(e.props.feedback&&!n){s.isValid=true}return{groupProps:u,validationProps:s,error:l?r.createElement(q,{type:"invalid"},Array.isArray(c)?c.map((function(e,t){return r.createElement("div",{key:t},e)})):c):null}};return e}V(b,[{key:"componentDidMount",value:function e(){var r;(r=this.registerAncestorField)===null||r===void 0?void 0:r.call(this,this.props.name,this.$fieldutil)}},{key:"componentWillUnmount",value:function e(){var r;(r=this.registerAncestorField)===null||r===void 0?void 0:r.call(this,this.props.name,null)}},{key:"render",value:function o(){var a=this;var b=this.props;var O=b.children,k=b.addons,j=b.label,w=b.helper,$=b.labelCol,C=b.wrapperCol,V=b.validationState,F=b.className,x=b.as,T=b.feedback,N=b.extra,A=b.noStyle,R=b.errorLevel,B=R===void 0?M:R,I=S(b,["children","addons","label","helper","labelCol","wrapperCol","validationState","className","as","feedback","extra","noStyle","errorLevel"]);var Y=C?y:c;var U=!x&&($||C)?h:x;if(j){if(i(j)){if($){j=n(j,_({column:true},$))}}else{j=r.createElement(u,Object.assign({column:!!$},$),j)}}var H=k?s:c;var L=k?{size:k.size}:undefined;if(k){if(k.pre){k.pre=r.createElement(s.Prepend,null,i(k.pre)?k.pre:r.createElement(s.Text,null,k.pre))}if(k.end){k.end=r.createElement(s.Append,null,i(k.end)?k.end:r.createElement(s.Text,null,k.end))}}else{k={}}if(w&&!i(w)){w=r.createElement(f,{className:"text-muted"},w)}if(!b.name){var W=this.latestValidationProps=this.fetchCurrentValidationProps(B),q=W.groupProps,K=W.error;Promise.resolve().then((function(){if(!g(a.latestValidationProps,a.fetchCurrentValidationProps(B))){a.forceUpdate()}}));return r.createElement(G,{value:this.registerField},r.createElement(p,Object.assign({},I,q,{as:U}),j,r.createElement(Y,C,r.createElement(H,L,k.pre,typeof O==="function"?O():O,k.end),K||w),N))}if(I.$memo===true){I.__DIFF__={childList:O,compositionValue:this.compositionValue}}else if(Array.isArray(I.$memo)){I.$memo=I.$memo.concat(this.compositionValue)}var Q=typeof O==="function"?O:t.only(O);var X=J(Q);if(X===l){if(Q.props.as==="select"&&Q.props.multiple){X="multipleSelect"}}switch(X){case v:case m:case"checkbox":case"radio":I.__TYPE__="checked";break;case"multipleSelect":I.__TYPE__="array";break;case D:case d:if(Q.props.type!=="radio"){I.__TYPE__="array"}break;case"checked":case"array":case"object":case"number":case"empty":I.__TYPE__=X;break}return r.createElement(e,Object.assign({},I,{passUtil:"$fieldutil",render:function e(t){var o,i;var c=b.valuePropName,l=c===void 0?"value":c,u=b.changePropName,s=u===void 0?"onChange":u,f=b.focusPropName,d=f===void 0?"onFocus":f,m=b.blurPropName,v=m===void 0?"onBlur":m;var y=t.$fieldutil,h=t[s],g=t[d],O=t[v],_=t[l],$=S(t,["$fieldutil",s,d,v,l].map(E));var V=y.$invalid,F=y.$dirty,x=y.$touched,T=y.$focused,R=y.$getFirstError;var D;switch(I.__TYPE__){case"checked":case"checkbox":case"radio":var G=b.checked,M=G===void 0?true:G,W=b.unchecked,q=W===void 0?false:W;D={checked:_===M,onChange:function e(r){var t=r&&r.target?r.target.checked:r;h(t?M:q,r)}};break;default:D=(o={onCompositionEnd:function e(r){a.isComposing=false;delete a.compositionValue;h(r)},onCompositionStart:function e(){return a.isComposing=true}},P(o,s,X==="multipleSelect"?function(e){h([].slice.call(e.target.options).filter((function(e){return e.selected})).map((function(e){return e.value})),e)}:function(e){if(a.isComposing){a.compositionValue=e.target[l];a.forceUpdate()}else{for(var r=arguments.length,t=new Array(r>1?r-1:0),n=1;n<r;n++){t[n-1]=arguments[n]}h.apply(void 0,[e].concat(t))}}),P(o,l,"compositionValue"in a?a.compositionValue:_),P(o,v,(function(){if(a.isComposing){a.isComposing=false;delete a.compositionValue;h.apply(void 0,arguments)}return O.apply(void 0,arguments)})),P(o,"name",I.name),o);break}var J=a.getValidationProps(B,V,F,x,T,R()),K=J.groupProps,Z=J.validationProps,ee=J.error;D=Object.assign((i={},P(i,d,g),P(i,v,O),i),D,Z);var re=typeof Q==="function"?Q(D):n(Q,D);return r.createElement(z,null,(function(e){if(A){a.$fieldutil=y;a.registerAncestorField=e;return re}return r.createElement(p,Object.assign({},$,K,{as:U}),j,r.createElement(Y,C,r.createElement(H,L,k.pre,re,k.end),ee||w),N)}))}}))}}]);return b}(o);U(".valid-feedback:empty,.invalid-feedback:empty","display: none !important");U(".has-error .invalid-feedback","display: block");var Q=function(e){x(o,e);var r=B(o);function o(){$(this,o);return r.apply(this,arguments)}V(o,[{key:"render",value:function e(){var r=this.props,o=r.children,i=r.name,a=r.onChange,c=r.value,l=r.onFocus,u=r.onBlur,s=r.isValid,f=r.isInvalid;var p=function e(r){a(r.target.value,r)};return t.map(o,(function(e){var r=e.props.value;return n(e,{isValid:s,isInvalid:f,checked:c===r,onChange:p,onFocus:l,onBlur:u,name:i})}))}}]);return o}(o);export{D as CheckboxGroup,K as FormGroup,Q as RadioGroup,D as SwitchGroup,W as setErrorLevel};
