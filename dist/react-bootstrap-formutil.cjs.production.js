"use strict";Object.defineProperty(exports,"__esModule",{value:true});var e=require("react-formutil");var r=require("react");var t=require("react-bootstrap");var n=require("react-is");var o=require("react-fast-compare");function i(e){return e&&typeof e==="object"&&"default"in e?e:{default:e}}var a=i(r);var l=i(n);var u=i(o);function c(e,r,t){if(r in e){Object.defineProperty(e,r,{value:t,enumerable:true,configurable:true,writable:true})}else{e[r]=t}return e}var s=c;function f(e,r){return r={exports:{}},e(r,r.exports),r.exports}var p=f((function(e){function r(t){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){e.exports=r=function e(r){return typeof r}}else{e.exports=r=function e(r){return r&&typeof Symbol==="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r}}return r(t)}e.exports=r}));function d(e,r){if(p(e)!=="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==undefined){var n=t.call(e,r||"default");if(p(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var v=d;function m(e){var r=v(e,"string");return p(r)==="symbol"?r:String(r)}var y=m;function h(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);if(r)n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}));t.push.apply(t,n)}return t}function b(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};if(r%2){h(Object(t),true).forEach((function(r){s(e,r,t[r])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(e,Object.getOwnPropertyDescriptors(t))}else{h(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}}return e}var g=b;function E(e,r){if(e==null)return{};var t={};var n=Object.keys(e);var o,i;for(i=0;i<n.length;i++){o=n[i];if(r.indexOf(o)>=0)continue;t[o]=e[o]}return t}var P=E;function O(e,r){if(e==null)return{};var t=P(e,r);var n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++){n=i[o];if(r.indexOf(n)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(e,n))continue;t[n]=e[n]}}return t}var k=O;function j(e,r){if(!(e instanceof r)){throw new TypeError("Cannot call a class as a function")}}var C=j;function _(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}function x(e,r,t){if(r)_(e.prototype,r);if(t)_(e,t);return e}var w=x;var V=f((function(e){function r(t,n){e.exports=r=Object.setPrototypeOf||function e(r,t){r.__proto__=t;return r};return r(t,n)}e.exports=r}));function F(e,r){if(typeof r!=="function"&&r!==null){throw new TypeError("Super expression must either be null or a function")}e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:true,configurable:true}});if(r)V(e,r)}var S=F;var $=f((function(e){function r(t){e.exports=r=Object.setPrototypeOf?Object.getPrototypeOf:function e(r){return r.__proto__||Object.getPrototypeOf(r)};return r(t)}e.exports=r}));function T(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}var G=T;function I(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}var R=I;function N(e,r){if(r&&(p(r)==="object"||typeof r==="function")){return r}return R(e)}var A=N;function B(e){var r=G();return function t(){var n=$(e),o;if(r){var i=$(this).constructor;o=Reflect.construct(n,arguments,i)}else{o=n.apply(this,arguments)}return A(this,o)}}var D=B;var q=function(e){S(n,e);var t=D(n);function n(){C(this,n);return t.apply(this,arguments)}w(n,[{key:"render",value:function e(){var t=this.props,n=t.children,o=t.name,i=t.onChange,a=t.value,l=t.onFocus,u=t.onBlur,c=t.isValid,s=t.isInvalid;var f=function e(r){var t=r.target,n=t.checked,o=t.value;var l=a||[];i(n?l.concat(o):l.filter((function(e){return e!==o})))};return r.Children.map(n,(function(e){var t=e.props.value;return r.cloneElement(e,{isValid:c,isInvalid:s,checked:!!a&&a.indexOf(t)>-1,onChange:f,onFocus:l,onBlur:u,name:o})}))}}]);return n}(r.Component);q.formutilType="array";var L;try{var Y=document.createElement("style");Y.type="text/css";document.getElementsByTagName("head")[0].appendChild(Y);L=document.styleSheets[document.styleSheets.length-1]}catch(e){}function U(e,r){if(L){if(L.insertRule){L.insertRule("".concat(e," { ").concat(r," }"),0)}else if(L.addRule){L.addRule(e,r,0)}}}var H=l["default"].isValidElementType;var z=r.createContext({}),M=z.Consumer,W=z.Provider;var J=1;var K=function e(r){J=r};var Q=t.FormControl.Feedback;function X(e){if(e){var r=e.type;if(H(r)){if(r.formutilType){return r.formutilType}if(typeof r==="string"&&e.props.type){return e.props.type}}return r||e}}var Z=function(n){S(i,n);var o=D(i);function i(){var e;C(this,i);for(var r=arguments.length,t=new Array(r),n=0;n<r;n++){t[n]=arguments[n]}e=o.call.apply(o,[this].concat(t));e.fields={};e.registerField=function(r,t){return t?e.fields[r]=t:delete e.fields[r]};e.latestValidationProps=null;e.checkHasError=function(e,r,t,n,o){switch(e){case 0:return r&&t&&n;case 1:return r&&t;case 2:return r;default:return false}};e.fetchCurrentValidationProps=function(r){var t=Object.keys(e.fields).map((function(r){return e.fields[r].$new()}));var n=t.filter((function(e){return e.$invalid}));var o=n.length>0;var i=t.some((function(e){return e.$dirty}));var a=t.some((function(e){return e.$touched}));var l=t.some((function(e){return e.$focused}));var u=n.map((function(t){var n=t.$invalid,o=t.$focused,i=t.$touched,a=t.$dirty,l=t.$getFirstError;var u=e.checkHasError(r,n,a,i,o);return u&&l()})).filter(Boolean);return e.getValidationProps(r,o,i,a,l,u)};e.getValidationProps=function(r,t,n,o,i,l){var u=e.checkHasError(r,t,n,o,i);var c={className:[e.props.className,u&&"has-error",t?"is-invalid":"is-valid",n?"is-dirty":"is-pristine",o?"is-touched":"is-untouched",i?"is-focused":"is-unfocused"].filter(Boolean).join(" ")};var s={};if(u){s.isInvalid=true}if(e.props.feedback&&!t){s.isValid=true}return{groupProps:c,validationProps:s,error:u?a["default"].createElement(Q,{type:"invalid"},Array.isArray(l)?l.map((function(e,r){return a["default"].createElement("div",{key:r},e)})):l):null}};return e}w(i,[{key:"componentDidMount",value:function e(){var r;(r=this.registerAncestorField)===null||r===void 0?void 0:r.call(this,this.props.name,this.$fieldutil)}},{key:"componentWillUnmount",value:function e(){var r;(r=this.registerAncestorField)===null||r===void 0?void 0:r.call(this,this.props.name,null)}},{key:"render",value:function n(){var o=this;var i=this.props;var l=i.children,c=i.addons,f=i.label,p=i.helper,d=i.labelCol,v=i.wrapperCol,m=i.validationState,h=i.className,b=i.as,E=i.feedback,P=i.extra,O=i.noStyle,j=i.errorLevel,C=j===void 0?J:j,_=k(i,["children","addons","label","helper","labelCol","wrapperCol","validationState","className","as","feedback","extra","noStyle","errorLevel"]);var x=v?t.Col:r.Fragment;var w=!b&&(d||v)?t.Row:b;if(f){if(r.isValidElement(f)){if(d){f=r.cloneElement(f,g({column:true},d))}}else{f=a["default"].createElement(t.FormLabel,Object.assign({column:!!d},d),f)}}var V=c?t.InputGroup:r.Fragment;var F=c?{size:c.size}:undefined;if(c){if(c.pre){c.pre=a["default"].createElement(t.InputGroup.Prepend,null,r.isValidElement(c.pre)?c.pre:a["default"].createElement(t.InputGroup.Text,null,c.pre))}if(c.end){c.end=a["default"].createElement(t.InputGroup.Append,null,r.isValidElement(c.end)?c.end:a["default"].createElement(t.InputGroup.Text,null,c.end))}}else{c={}}if(p&&!r.isValidElement(p)){p=a["default"].createElement(t.FormText,{className:"text-muted"},p)}if(!i.name){var S=this.latestValidationProps=this.fetchCurrentValidationProps(C),$=S.groupProps,T=S.error;Promise.resolve().then((function(){if(!u["default"](o.latestValidationProps,o.fetchCurrentValidationProps(C))){o.forceUpdate()}}));return a["default"].createElement(W,{value:this.registerField},a["default"].createElement(t.FormGroup,Object.assign({},_,$,{as:w}),f,a["default"].createElement(x,v,a["default"].createElement(V,F,c.pre,typeof l==="function"?l():l,c.end),T||p),P))}if(_.$memo===true){_.__DIFF__={childList:l,compositionValue:this.compositionValue}}else if(Array.isArray(_.$memo)){_.$memo=_.$memo.concat(this.compositionValue)}var G=typeof l==="function"?l:r.Children.only(l);var I=X(G);if(I===t.FormControl){if(G.props.as==="select"&&G.props.multiple){I="multipleSelect"}}switch(I){case t.FormCheck:case t.ToggleButton:case"checkbox":case"radio":_.__TYPE__="checked";break;case"multipleSelect":_.__TYPE__="array";break;case q:case t.ToggleButtonGroup:if(G.props.type!=="radio"){_.__TYPE__="array"}break;case"checked":case"array":case"object":case"number":case"empty":_.__TYPE__=I;break}return a["default"].createElement(e.EasyField,Object.assign({},_,{passUtil:"$fieldutil",render:function e(n){var l,u;var d=i.valuePropName,m=d===void 0?"value":d,h=i.changePropName,b=h===void 0?"onChange":h,g=i.focusPropName,E=g===void 0?"onFocus":g,j=i.blurPropName,S=j===void 0?"onBlur":j;var $=n.$fieldutil,T=n[b],R=n[E],N=n[S],A=n[m],B=k(n,["$fieldutil",b,E,S,m].map(y));var D=$.$invalid,q=$.$dirty,L=$.$touched,Y=$.$focused,U=$.$getFirstError;var H;switch(_.__TYPE__){case"checked":case"checkbox":case"radio":var z=i.checked,W=z===void 0?true:z,J=i.unchecked,K=J===void 0?false:J;H={checked:A===W,onChange:function e(r){var t=r&&r.target?r.target.checked:r;T(t?W:K,r)}};break;default:H=(l={onCompositionEnd:function e(r){o.isComposing=false;delete o.compositionValue;T(r)},onCompositionStart:function e(){return o.isComposing=true}},s(l,b,I==="multipleSelect"?function(e){T([].slice.call(e.target.options).filter((function(e){return e.selected})).map((function(e){return e.value})),e)}:function(e){if(o.isComposing){o.compositionValue=e.target[m];o.forceUpdate()}else{for(var r=arguments.length,t=new Array(r>1?r-1:0),n=1;n<r;n++){t[n-1]=arguments[n]}T.apply(void 0,[e].concat(t))}}),s(l,m,"compositionValue"in o?o.compositionValue:A),s(l,S,(function(){if(o.isComposing){o.isComposing=false;delete o.compositionValue;T.apply(void 0,arguments)}return N.apply(void 0,arguments)})),s(l,"name",_.name),l);break}var Q=o.getValidationProps(C,D,q,L,Y,U()),X=Q.groupProps,Z=Q.validationProps,ee=Q.error;H=Object.assign((u={},s(u,E,R),s(u,S,N),u),H,Z);var re=typeof G==="function"?G(H):r.cloneElement(G,H);return a["default"].createElement(M,null,(function(e){if(O){o.$fieldutil=$;o.registerAncestorField=e;return re}return a["default"].createElement(t.FormGroup,Object.assign({},B,X,{as:w}),f,a["default"].createElement(x,v,a["default"].createElement(V,F,c.pre,re,c.end),ee||p),P)}))}}))}}]);return i}(r.Component);U(".valid-feedback:empty,.invalid-feedback:empty","display: none !important");U(".has-error .invalid-feedback","display: block");var ee=function(e){S(n,e);var t=D(n);function n(){C(this,n);return t.apply(this,arguments)}w(n,[{key:"render",value:function e(){var t=this.props,n=t.children,o=t.name,i=t.onChange,a=t.value,l=t.onFocus,u=t.onBlur,c=t.isValid,s=t.isInvalid;var f=function e(r){i(r.target.value,r)};return r.Children.map(n,(function(e){var t=e.props.value;return r.cloneElement(e,{isValid:c,isInvalid:s,checked:a===t,onChange:f,onFocus:l,onBlur:u,name:o})}))}}]);return n}(r.Component);Object.keys(e).forEach((function(r){if(r!=="default")Object.defineProperty(exports,r,{enumerable:true,get:function(){return e[r]}})}));exports.CheckboxGroup=q;exports.FormGroup=Z;exports.RadioGroup=ee;exports.SwitchGroup=q;exports.setErrorLevel=K;
